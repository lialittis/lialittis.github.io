<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>GraphSLAM with ICP | Tianchi YU</title> <meta name="author" content="Tianchi YU"> <meta name="description" content="two SLAM approaches based on the laser scan correlation method named Iterated Closest Point (ICP)"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://lialittis.github.io/projects/GraphSLAM/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Tianchi </span>YU</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">GitRepos</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">GraphSLAM with ICP </h1> <p class="post-description">two SLAM approaches based on the laser scan correlation method named Iterated Closest Point (ICP)</p> </header> <article> <h1 id="introduction">Introduction</h1> <p>In this practical work, we will work on two SLAM approaches based on the laser scan correlation method named Iterated Closest Point (ICP).</p> <h1 id="incremental-slam">Incremental SLAM</h1> <p><em>Q: By looking at the code and at the course, explain in details what is the algorithm implemented in this script. In particular explain what is the scan used as a reference to compute a new scan position. Highlight the difference with the ICP localisation proposed in the first ICP practical work.</em></p> <p>The algorithm in the program is that before append one new scan into our constructing map, calculate its distance with all the previous poses of scans, and sort the scans according to the distances. Perform ICP with closest scan and calculate the distance between the closest scan pose and the new scan pose, if the distance is larger than a threshold, accept this scan.</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPIncrementalSLAM.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="ICP Incremental SLAM" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The reference of the scan is the closest scan from the previous scans accepted by our map.</p> <p><em>Q: When a loop is closed in the environment, explain what is corrected or not in the localisation and in the map.</em></p> <p>When the loop is closed, only the last pose that closes the loop (A.K.A the pose with the same localization) will be corrected, also the corresponding scanning map for that pose. Nothing else will be corrected because this method doesn’t update other scans or the map(without backtracking).</p> <p><em>Q: What are the role of the step and distThresholdAdd parameters ? Explain what happens for each of them when they are decreased or increased. What eventually happens when they are too large ? Suggest a reasonable compromise for their values.</em></p> <p>The step defines how frequency we pick the scans from the data set, it means we pick only one scan by one step. The distThresholdAdd defines the minimal distance between the scans in the map, it means too closed scans will not be accepted.</p> <p>If only the step decreases, the number of scans taken is larger, the running time will increase. However, because the distThresholdAdd doesn’t allow the too closed scans, the scans accepted by the map may not change. If the step increases, the number of scans in the scan list decreases, so the data will be more sparse and the result is not precise and uncorrected with a too-large step. In that case, distThresholdAdd may have less and less influence because the scans taken in the list are already sparse enough.</p> <p>If only distThreshold decreases, the number of scans added becomes larger until the maximum. If the distThreshold increases, the scans added in the map will decrease.</p> <p>As we have discussed above, if step or distThresholdAdd become too large, the scans taken in the list and the scans added in the map will be few, and there is not enough data to construct our map. To compromise these two values, we need to make sure there are enough scans calculated by ICP method, so the step can not be too large, we could take it as 3~5. And for a reasonable distThresholdAdd, we need to make sure it makes sense, which means we need to watch if there is an obvious filtering effect after applying it, but also make sure the rest scans are precise enough.</p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPIncrementalSLAM0.2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPIncrementalSLAM0.5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h1 id="graph-slam">Graph SLAM</h1> <p>The algorithm: In this program, we have two parts - build the graph and update/optimize it. At first, to construct the map, after getting list of map scan sorted by distance, we perform ICP with closest scan to correct future odometry and add the scan if it is not too closed with the previous ones. But it does one more step for build the graph - adding edges: keep only the scans below a distance threshold(from one current scan), or the closest one, then compute position of new scan with respect to the reference scan, and create a corresponding relative pose if the error is small and add one edge to the graph. Note that, in this step, we take the reference scan among the closest map scans(previous).</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPGraphSLAM.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="ICP Graph SLAM" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>When the graph is built with the relative pose, we need to optimize it, which means each scan pose from its neighbors is recomputed. We create a list of poses for one scan through neighbors and relative positions and and take the mean of the pose list as the new pose. Take the largest error as the update value, then stop the process until the updates fall below a threshold.</p> <p><strong>Compared with the incremental SLAM method, when constructing the map, the new algorithm keeps updating the pose according to the nearest poses in the map and the relative position of the new scan, while the previous algorithm directly accepts the result of ICP method.</strong></p> <p>When a loop is closed, the map/wall is apparently corrected and every pose/trajectory is corrected too, because every scan in the map is updated during the optimization process. It has the capacity of backtracking(retour en arrière).</p> <p><em>Q: What are the role of the distThresholdAdd and distThresholdMatch parameters ? Explain what happens for each of them when they are decreased or increased. What happens when distThresholdAdd &gt; distThresholdMatch? Suggest a reasonable compromise.</em></p> <p>The distThresholdAdd is still the threshold of distance to add scan into the map. It defines the minimal distance between the scans in the map, it means too closed scans will not be accepted. The distThresholdMatch is a distance threshold used to chose some closed poses which are already in the map, and used to update the graph. The relative pose will be recomputed according to the poses, whose distance with current new scan pose is below distThresholdMatch.</p> <p>If only distThresholdAdd decreases, the number of scans added becomes larger until the maximum. If the distThresholdAdd increases, the scans added to the map will decrease.</p> <p>If only distThresholdMatch decreases, there will be less pose in the list used to calculate the relative pose. If it increases, it means the reference poses for the relative pose increase, and the relative pose may be more reasonable.</p> <p>Once distThresholdAdd &gt; distThresholdMatch, then the relative pose of each new scan will only calculate based on the closest one pose. The performance is limited.</p> <p>To choose a reasonable compromise of these two parameters, we need to keep distThresholdAdd smaller than distThresholdMatch. At the same time, a too-small distThresholdAdd causes some unnecessary steps that are too close and a too-big distThresholdMatch makes no sense because those far poses have no meaning of reference for the relative pose. To calculate the relative pose, it is better to have 1-2 nearest poses as the reference, so it is better to take the distThresholdMatch around 2 times larger than distThresholdAdd. To make it clearer, we do the tests below.</p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPGraphSLAM0.1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPGraphSLAM0.5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPGraphSLAM0.6.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ICP/ICPGraphSLAM1.0.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Tianchi YU. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>