<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>ODE Dynamical System | Tianchi YU</title> <meta name="author" content="Tianchi YU"> <meta name="description" content="Lane changing operations of autonomous vehicles(with Simulink Simulation)"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://lialittis.github.io/projects/lane_changing_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Tianchi </span>YU</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">GitRepos</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">ODE Dynamical System <a href="/assets/pdf/lane_change_project.pdf" target="_blank" rel="noopener noreferrer" class="float-right"><i class="fas fa-file-pdf"></i> </a> </h1> <p class="post-description">Lane changing operations of autonomous vehicles(with Simulink Simulation)</p> </header> <article> <h1 id="introduction">Introduction</h1> <p>This is a mini-project that models and simulates of lane change maneuvers of autonomous vehicles. Here we construct a bicycle model for each vehicle and solve the dynamical system based on state-space equations. Using LQR linear controller, we construct a closed-loop model of the system and simulate the whole process by MATLAB/Simulink. The results can verify our design, to a certain extent.</p> <p>The lane change strategy can be divided according to the existence of road infrastructure or reference trajectory. Here, we provide a model that could display the maneuver of lane change and express the security based on the simulation. To specify, our model includes four autonomous vehicles, where three cars are driving in the right lane and one is in the left lane. The purpose is that the vehicle in the left lane wants to move to the right while avoiding collisions. Suppose that each vehicle is equipped with sensors (with reasonable errors) and can communicate with its neighboring cars (send necessary information). This maneuver can be considered as an automated process.</p> <p>The vehicle dynamics are represented by a dynamic bicycle model, and each vehicle is composed of a linear controller (which is LQR controller actually) that regulates its own lateral and longitudinal behavior. In order to ensure safe handling and meet traffic regulations, we use a cooperative driving control scheme that determines the actions of each vehicle.</p> <h1 id="model---system-description">Model - System Description</h1> <p>In this section, we present the details of the scenario and describe the whole system. At first, let’s consider the real scenario on the road. There are four vehicles on the road, three of them are on the right lane with same speed and another one are on the left lane. Now we want to implement one maneuver of automated merging maneuver, i.e. how to insert a vehicle from the on-ramp in the middle between two pre-selected vehicles of a platoon in the main lane. Specifically, the vehicle on the lane has to merge to the right one, because of high layers like road infrastructure or the emergency, e.g. obstacle avoidance.</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/lane_change.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Lane Change Scenario" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Suppose that all vehicles are equipped with sensors used to measure the orientation, position and velocity. Besides, all vehicles have the capacity to communicate with their neighboring vehicles, the important information are longitudinal position and speed.</p> <p>Notice that, we suppose the width of each lane is 5m, and we take the y coordinate of middle line of the right lane as 0.</p> <h2 id="system-specifications">System Specifications</h2> <p>Before design the model, we should define the specifications of our system. For each vehicle, we care about its safety margins with surrounding vehicles, the respect for traffic rules and the physical constraints,etc. More precisely, they could be interpreted as:</p> <ol> <li> <p>The distance of two neighboring vehicles of the platoon should always maintain larger than a given threshold,</p> </li> <li> <p>The vehicles of the platoon should maintain a constant time gap($t_{gap}$) (a.k.a time-to-collision) between each other;</p> </li> <li> <p>The manoeuvre should only be initiated if the time gap is greater than a given value($t_{gap_m}$),</p> </li> <li> <p>Once the manoeuvre is finished, the vehicles should form a platoon and the velocity of all vehicles should reach $|v_{des} \pm \epsilon |$, where $\epsilon$ is a user-defined metric,</p> </li> <li> <p>The practical velocity bounds of vehicles exist, e.g. $v_{min} \leq v \leq v_{max} $,</p> </li> <li> <p>The control inputs are bounded.</p> </li> </ol> <h2 id="vehicle-dynamics">Vehicle Dynamics</h2> <p>For vehicle dynamics, there are a large variety of models. As in the literature of autonomous vehicles, dynamic and kinematic bicycle models are commonly used. In this case, instead of a kinematic model, a dynamic model for lateral vehicle motion must be developed. So we consider a dynamic bicycle model with a linear tire model. The model is assumed linear to avoid computational complexity.</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/bicycle_model.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Bicycle Model" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The state vector contains (we take the position of the rear axle of vehicles as the reference of longitudinal and lateral position):</p> <ul> <li>the longitudinal position of the rear axle $p_{x,r}$</li> <li>the lateral position of the rear axle $p_{y,r}$</li> <li>the yaw angle $\psi$</li> <li>the longitudinal velocity $v_x$</li> <li>the lateral velocity at the center of the rear axle $v_y$</li> <li>the yaw rate $\omega$</li> </ul> <p>The inputs of command are the longitudinal acceleration $a_x$ and the steering angle $\delta$. The state vector is measured and we model additive measurement noise in all state dimensions, which are $e^m_{x,r}, e^m_{y,r}, e^,<em>{\psi}, e^m</em>{v_x}, e^m_{v_y}, e^m_{\omega}$.</p> <p>Starting from first-principles, the differential equations of the dynamic bicycle model are defined:</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/differential_equations_dynamic_bicycle.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="linearization">Linearization</h2> <p>The nonlinear model is linearized around a set of operating points using standard point-wise linearization.For linearization purposes in our case, because of the stable equilibrium and the destined velocity of vehicles(we set as 70 km/h), we consider a set point $x_{op} = [0; 0; 0; 70/3.6; 0; 0]$ and do Taylor expansion around the point.</p> <h2 id="linear-controller">Linear Controller</h2> <p>The objective of the linear controller of each vehicle is to regulate its position and velocity in accordance with the behavior of the other vehicles. At the same time, the lane change maneuver should be safety. Once the maneuver is completed, the vehicle platoon should maintain the predefined vehicle speed $v_{des}$.</p> <p>\($ u = -K\cdot y = -K\cdot(x+v)\)$</p> <p>We opt for an <strong>LQR (Linear Quadratic Regulation)</strong> controller since it is a well established design technique that provides practical feedback gains. LQR is an optimal multivariable feedback control approach which minimizes the deviation of the state trajectories of the closed-loop system while requiring minimum controller effort. The behavior of an LQR controller is determined by two parameters: state and control weighting matrices. These two matrices are design parameters and influence the success of the LQR controller synthesis.Now we need to determine the weighting matrices of the cost function.</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/closed_loop.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h1 id="supervisory-control">Supervisory Control</h1> <p>You are able to find more details in the Report PDF.</p> <h1 id="simulation">Simulation</h1> <p>We simulate the whold model by MATLAB/Simulink. At first we construct the control model for each vehicle. Then, connect all vehicles following the dependencies between each other. We construct the global system and realize the communication among the vehicles, using the basic information(longitudinal position and velocity, etc).</p> <p>The global model and the curves displays could be represented below. The references come from the output of other vehicles, with the errors of sensors. The signal processing and dynamical control are realised separately by models of each vehicle.</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/global_system.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Global model for whole system" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="example-of-leader-vehicle">Example of leader Vehicle</h2> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/leader_vehicle.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Leader Vehicle Model" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/supervisory_control_leader.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Supervisory Control Part of Leader Vehicle" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>For the merging vehicle, we need to consider it as a special case. As we have divided the lane change maneuver into two phase, we need to set one logic switching based on the condition $\phi$ we have defined.</p> <div class="row"> <div class="col-sm mt-12 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/LQR_controller_leader.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="LQR Controller of Leader Vehicle" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="simulation-results">Simulation Results</h2> <p>To make a clear implementation of the lane change maneuver and ignore the unnecessary errors($e_\psi^m$ and $e_\omega^m$), we get a complete/dynamic lane change process for our case. Here, circles stand for the position of the vehicles in the right lane, and star stands for the merging vehicle.</p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/phase1_noerror.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Phase 1: Preparation" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/phase2_noerror.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Phase 2: Merging" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/after_noerror.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="After merging" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/projects/ODE/stable_noerror.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Stable results" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h1 id="conclusion">Conclusion</h1> <p>We construct the dynamical model of vehicles by classical bicycle model and study one case of real scenario of lane change using a global system based on the vehicle model. To realize the performance of autonomous control, we design a LQR controller and solve the state-space equations, calculate the feedback gain which is used in the simulation. Also, we design a supervisory control to meet the safety requirements during the merging process, using the references and dependencies of the velocity and position information. Finally, we simulate the lane change maneuver by Simulink and verify the correctness of our system.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Tianchi YU. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>